<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flourishly - Grateful & 1% Better</title>
    <link rel="icon" type="image/svg+xml" href="lotus-logo.svg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- ========== AUTH SCREEN ========== -->
    <div id="authScreen" class="auth-screen">
        <div class="auth-container">
            <div class="auth-logo">
                <img src="lotus-logo.svg" alt="Flourishly" class="auth-logo-image">
                <h1 class="auth-logo-text">Flourishly</h1>
                <p class="auth-tagline">Grateful moments. 1% better every day.</p>
            </div>

            <div class="auth-card">
                <div class="auth-tabs">
                    <button class="auth-tab active" data-tab="login" onclick="switchAuthTab('login')">Sign In</button>
                    <button class="auth-tab" data-tab="register" onclick="switchAuthTab('register')">Register</button>
                </div>

                <div id="authError" class="auth-error" style="display:none;"></div>

                <!-- Login Form -->
                <div id="loginForm">
                    <div class="auth-field">
                        <label>Email</label>
                        <input type="email" id="loginEmail" placeholder="your@email.com" autocomplete="email">
                    </div>
                    <div class="auth-field">
                        <label>Password</label>
                        <input type="password" id="loginPassword" placeholder="Enter your password" autocomplete="current-password">
                    </div>
                    <button class="auth-submit-btn" onclick="loginWithEmail()">Sign In</button>
                    <button class="auth-link-btn" onclick="switchAuthTab('reset')">Forgot password?</button>
                </div>

                <!-- Register Form -->
                <div id="registerForm" style="display:none;">
                    <div class="auth-field">
                        <label>Name</label>
                        <input type="text" id="registerName" placeholder="Your name" autocomplete="name">
                    </div>
                    <div class="auth-field">
                        <label>Email</label>
                        <input type="email" id="registerEmail" placeholder="your@email.com" autocomplete="email">
                    </div>
                    <div class="auth-field">
                        <label>Password</label>
                        <input type="password" id="registerPassword" placeholder="At least 6 characters" autocomplete="new-password">
                    </div>
                    <div class="auth-field">
                        <label>Confirm Password</label>
                        <input type="password" id="registerConfirmPassword" placeholder="Confirm your password" autocomplete="new-password">
                    </div>
                    <button class="auth-submit-btn" onclick="registerWithEmail()">Create Account</button>
                </div>

                <!-- Reset Password Form -->
                <div id="resetForm" style="display:none;">
                    <p class="auth-reset-info">Enter your email and we'll send you a link to reset your password.</p>
                    <div class="auth-field">
                        <label>Email</label>
                        <input type="email" id="resetEmail" placeholder="your@email.com" autocomplete="email">
                    </div>
                    <button class="auth-submit-btn" onclick="resetPassword()">Send Reset Link</button>
                    <button class="auth-link-btn" onclick="switchAuthTab('login')">Back to Sign In</button>
                </div>

                <div class="auth-divider">
                    <span>or</span>
                </div>

                <button class="auth-google-btn" onclick="loginWithGoogle()">
                    <svg width="18" height="18" viewBox="0 0 48 48"><path fill="#EA4335" d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"/><path fill="#4285F4" d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"/><path fill="#FBBC05" d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"/><path fill="#34A853" d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"/></svg>
                    Continue with Google
                </button>
            </div>
        </div>
    </div>

    <!-- ========== MAIN APP (hidden until auth) ========== -->
    <div id="app" style="display:none;">
        <!-- Header -->
        <header id="header">
            <div class="header-left">
                <button id="archiveBtn" class="header-nav-btn" onclick="showHistory()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/>
                        <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/>
                    </svg>
                    <span>Archive</span>
                </button>
                <button id="homeBtn" class="icon-btn" onclick="goHome()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                        <polyline points="9 22 9 12 15 12 15 22"/>
                    </svg>
                </button>
            </div>
            <div class="header-center">
                <div class="mode-toggle">
                    <button class="mode-toggle-btn active" data-mode="grateful" onclick="switchMode('grateful')">Grateful</button>
                    <button class="mode-toggle-btn" data-mode="better" onclick="switchMode('better')">1% Better</button>
                </div>
                <div class="app-logo">
                    <img src="lotus-logo.svg" alt="Flourishly" class="logo-image">
                    <span class="logo-text">Flourishly</span>
                </div>
                <h1 id="headerTitle" style="display: none;">Today's Gratitude</h1>
            </div>
            <div class="header-right">
                <div class="streak-badge" id="streakBadge">
                    <div class="streak-number" id="streakNumber">0üî•</div>
                </div>
                <button id="addressBookBtn" class="header-nav-btn" onclick="showAddressBook()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                        <circle cx="9" cy="7" r="4"/>
                        <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
                        <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                    </svg>
                    <span>Contacts</span>
                </button>
                <button id="sendGratitudeBtn" class="header-nav-btn" onclick="showSendGratitude()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 2L11 13"/>
                        <path d="M22 2L15 22L11 13L2 9L22 2Z"/>
                    </svg>
                    <span>Send</span>
                </button>
                <button id="adminHeaderBtn" class="header-nav-btn" onclick="showAdminDashboard()" style="display:none;">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5z"/>
                        <circle cx="12" cy="12" r="3"/>
                    </svg>
                    <span>Admin</span>
                </button>
                <button id="settingsBtn" class="header-nav-btn" onclick="showSettings()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3"/>
                        <path d="M12 1v6m0 6v6m5.2-13.2l-4.2 4.2m-2 2l-4.2 4.2m10.4 0l-4.2-4.2m-2-2l-4.2-4.2"/>
                    </svg>
                    <span>Settings</span>
                </button>
                <div class="user-menu-wrapper">
                    <button id="userMenuBtn" class="header-nav-btn" onclick="toggleUserMenu()">
                        <div id="userAvatar" class="user-avatar">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                                <circle cx="12" cy="7" r="4"/>
                            </svg>
                        </div>
                        <span>Account</span>
                    </button>
                    <div id="userMenuDropdown" class="user-menu-dropdown" style="display:none;">
                        <div class="user-menu-info">
                            <div id="userDisplayName" class="user-menu-name">User</div>
                            <div id="userDisplayEmail" class="user-menu-email">email</div>
                        </div>
                        <button id="adminDashboardBtn" class="user-menu-item" onclick="showAdminDashboard()" style="display:none;">Admin Dashboard</button>
                        <button class="user-menu-item" onclick="signOut()">Sign Out</button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main id="mainContent">
            <!-- Welcome/Home Screen -->
            <div id="welcomeScreen" class="screen active">
                <div class="welcome-layout">
                    <!-- Center area with welcome circle -->
                    <div class="welcome-center">
                        <div class="welcome-circle" onclick="startJournaling()">
                            <h2 class="welcome-greeting" id="welcomeGreeting">Good evening, Sarah.</h2>
                            <p class="welcome-prompt">What's on your heart in this moment?</p>
                            <p class="welcome-tap-hint">Tap the circle to begin</p>
                        </div>
                    </div>

                    <!-- Birthday Reminder Panel (Right Side) -->
                    <div id="birthdayReminder" class="birthday-sidebar" style="display: none;">
                        <div class="birthday-sidebar-header">
                            <span class="birthday-icon">üéÇ</span>
                            <span class="birthday-title" id="birthdayTitle">Upcoming Birthdays</span>
                        </div>
                        <div class="birthday-list" id="birthdayList"></div>
                    </div>
                </div>
            </div>

            <!-- Entry Creation Screen -->
            <div id="entryScreen" class="screen">
                <div class="date-navigation">
                    <button class="date-nav-btn" onclick="previousDay()">‚óÄ</button>
                    <div class="date-display" id="todayDate"></div>
                    <button class="date-nav-btn" onclick="nextDay()">‚ñ∂</button>
                </div>

                <div class="entry-container">
                    <!-- Item 1 -->
                    <div class="gratitude-item" data-item="1">
                        <div class="item-header">
                            <span class="item-number">1</span>
                        </div>
                        <div class="suggestion-bubble" id="suggestion-1" onclick="useSuggestion(1)">
                            <span class="suggestion-bubble-icon">üí°</span>
                            <span class="suggestion-bubble-text" id="suggestion-text-1"></span>
                            <button class="suggestion-bubble-refresh" onclick="refreshSuggestion(1); event.stopPropagation();">üîÑ</button>
                        </div>
                        <textarea
                            class="item-input"
                            placeholder="What are you grateful for today?"
                            maxlength="500"
                            data-item-id="1"
                        ></textarea>
                        <div class="media-controls">
                            <button class="media-btn" onclick="openCamera(1)">üì∏ Camera</button>
                            <button class="media-btn" onclick="selectMedia(1, 'image')">üñºÔ∏è Gallery</button>
                        </div>
                        <div class="media-preview" id="preview-1"></div>
                    </div>

                    <!-- Item 2 -->
                    <div class="gratitude-item" data-item="2">
                        <div class="item-header">
                            <span class="item-number">2</span>
                        </div>
                        <div class="suggestion-bubble" id="suggestion-2" onclick="useSuggestion(2)">
                            <span class="suggestion-bubble-icon">üí°</span>
                            <span class="suggestion-bubble-text" id="suggestion-text-2"></span>
                            <button class="suggestion-bubble-refresh" onclick="refreshSuggestion(2); event.stopPropagation();">üîÑ</button>
                        </div>
                        <textarea
                            class="item-input"
                            placeholder="What else brought you joy?"
                            maxlength="500"
                            data-item-id="2"
                        ></textarea>
                        <div class="media-controls">
                            <button class="media-btn" onclick="openCamera(2)">üì∏ Camera</button>
                            <button class="media-btn" onclick="selectMedia(2, 'image')">üñºÔ∏è Gallery</button>
                        </div>
                        <div class="media-preview" id="preview-2"></div>
                    </div>

                    <!-- Item 3 -->
                    <div class="gratitude-item" data-item="3">
                        <div class="item-header">
                            <span class="item-number">3</span>
                        </div>
                        <div class="suggestion-bubble" id="suggestion-3" onclick="useSuggestion(3)">
                            <span class="suggestion-bubble-icon">üí°</span>
                            <span class="suggestion-bubble-text" id="suggestion-text-3"></span>
                            <button class="suggestion-bubble-refresh" onclick="refreshSuggestion(3); event.stopPropagation();">üîÑ</button>
                        </div>
                        <textarea
                            class="item-input"
                            placeholder="One more thing to appreciate..."
                            maxlength="500"
                            data-item-id="3"
                        ></textarea>
                        <div class="media-controls">
                            <button class="media-btn" onclick="openCamera(3)">üì∏ Camera</button>
                            <button class="media-btn" onclick="selectMedia(3, 'image')">üñºÔ∏è Gallery</button>
                        </div>
                        <div class="media-preview" id="preview-3"></div>
                    </div>
                </div>

                <div class="action-buttons">
                    <button id="saveBtn" class="primary-btn" onclick="saveEntry()">Save Entry üíæ</button>
                    <button id="viewHistoryBtn" class="secondary-btn" onclick="showHistory()">View Past Entries</button>
                    <button id="entrySendGratitudeBtn" class="secondary-btn" onclick="showSendGratitude()">Send Gratitude üíå</button>
                    <button id="entryAddressBookBtn" class="secondary-btn" onclick="showAddressBook()">Address Book üìá</button>
                </div>
            </div>

            <!-- Historical View Screen -->
            <div id="historyScreen" class="screen">
                <div class="history-header">
                    <div class="view-switcher">
                        <button class="view-switch-btn" onclick="switchViewMode('week')">Week</button>
                        <button class="view-switch-btn active" onclick="switchViewMode('month')">Month</button>
                        <button class="view-switch-btn" onclick="switchViewMode('year')">Year</button>
                    </div>
                </div>

                <!-- Week View -->
                <div id="weekView" class="history-view">
                    <div class="week-layout">
                        <div class="week-nav">
                            <button class="calendar-nav-btn" onclick="previousWeek()">&#9664;</button>
                            <h2 class="week-title" id="weekTitle"></h2>
                            <button class="calendar-nav-btn" onclick="nextWeek()">&#9654;</button>
                        </div>
                        <div id="weekGrid" class="week-grid"></div>
                    </div>
                </div>

                <!-- Month View (Calendar) -->
                <div id="calendarView" class="history-view active">
                    <div class="calendar-layout">
                        <div class="calendar-container">
                            <div class="calendar-header">
                                <button class="calendar-nav-btn" onclick="previousMonth()">&#9664;</button>
                                <h2 class="calendar-month" id="calendarMonthYear"></h2>
                                <button class="calendar-nav-btn" onclick="nextMonth()">&#9654;</button>
                            </div>
                            <div id="calendarGrid" class="calendar-grid"></div>
                        </div>
                        <div id="calendarBirthdayPanel" class="calendar-birthday-panel" style="display:none;">
                            <div class="calendar-birthday-panel-header">
                                <span class="birthday-icon">üéÇ</span>
                                <span class="birthday-title">Upcoming Birthdays</span>
                            </div>
                            <div id="calendarBirthdayList" class="calendar-birthday-list"></div>
                        </div>
                        <div id="calendarDetailPane" class="calendar-detail-pane">
                            <div class="calendar-detail-placeholder">
                                <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                                    <line x1="16" y1="2" x2="16" y2="6"/>
                                    <line x1="8" y1="2" x2="8" y2="6"/>
                                    <line x1="3" y1="10" x2="21" y2="10"/>
                                </svg>
                                <p>Select a date to view details</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Year View -->
                <div id="yearView" class="history-view">
                    <div class="year-layout">
                        <div class="year-nav">
                            <button class="calendar-nav-btn" onclick="previousYear()">&#9664;</button>
                            <h2 class="year-title" id="yearTitle"></h2>
                            <button class="calendar-nav-btn" onclick="nextYear()">&#9654;</button>
                        </div>
                        <div id="yearGrid" class="year-grid"></div>
                    </div>
                </div>
            </div>

            <!-- Detail View Screen -->
            <div id="detailScreen" class="screen">
                <div id="detailContent"></div>
                <div class="action-buttons">
                    <button class="primary-btn" onclick="editEntry()">Edit Entry ‚úèÔ∏è</button>
                    <button class="secondary-btn" onclick="deleteEntry()">Delete Entry</button>
                </div>
            </div>

            <!-- Settings Screen -->
            <div id="settingsScreen" class="screen">
                <div class="settings-container">
                    <div class="settings-card">
                        <h2 class="settings-title">Settings</h2>

                        <div class="setting-item">
                            <label class="setting-label">Your Name</label>
                            <input type="text" id="userNameInput" class="setting-input" placeholder="Enter your name" maxlength="50">
                        </div>

                        <div class="setting-item">
                            <label class="setting-label">Welcome Message Style</label>
                            <select id="greetingStyle" class="setting-input">
                                <option value="auto">Auto (based on time of day)</option>
                                <option value="morning">Good morning</option>
                                <option value="afternoon">Good afternoon</option>
                                <option value="evening">Good evening</option>
                                <option value="simple">Hello</option>
                            </select>
                        </div>

                        <div class="setting-item">
                            <label class="setting-label">Color Scheme</label>
                            <select id="colorScheme" class="setting-input" onchange="applyColorScheme(this.value)">
                                <option value="warm-peach">Warm Peach (Default)</option>
                                <option value="lavender-dream">Lavender Dream</option>
                                <option value="mint-fresh">Mint Fresh</option>
                                <option value="sunset-glow">Sunset Glow</option>
                                <option value="ocean-breeze">Ocean Breeze</option>
                                <option value="rose-garden">Rose Garden</option>
                            </select>
                        </div>

                        <button class="primary-btn" onclick="saveSettings()">Save Settings</button>
                        <button class="secondary-btn" onclick="showAddressBook()">Manage Address Book</button>
                    </div>
                </div>
            </div>

            <!-- Address Book Screen -->
            <div id="addressBookScreen" class="screen">
                <div class="address-book-container">
                    <!-- Left Panel: Add/Edit Contact Form -->
                    <div class="address-book-form-panel">
                        <div class="settings-card">
                            <h3 id="contactFormTitle">Add New Contact</h3>
                            <input type="hidden" id="editingContactId" value="">

                            <!-- Contact Photo -->
                            <div class="setting-item contact-photo-section">
                                <div class="contact-photo-upload">
                                    <div class="contact-photo-preview" id="contactPhotoPreview">
                                        <span class="photo-placeholder">üì∑</span>
                                    </div>
                                    <div class="photo-upload-buttons">
                                        <button type="button" class="secondary-btn small" onclick="selectContactPhoto()">Choose Photo</button>
                                        <button type="button" class="secondary-btn small" onclick="clearContactPhoto()" id="clearPhotoBtn" style="display: none;">Remove</button>
                                    </div>
                                    <input type="file" id="contactPhotoInput" accept="image/*" style="display: none;" onchange="handleContactPhotoSelect(event)">
                                </div>
                            </div>

                            <div class="setting-item">
                                <label class="setting-label">Name *</label>
                                <input type="text" id="contactName" class="setting-input" placeholder="Enter name" maxlength="50">
                            </div>
                            <div class="setting-item">
                                <label class="setting-label">Phone Number *</label>
                                <input type="tel" id="contactPhone" class="setting-input" placeholder="Enter phone number" maxlength="20">
                            </div>
                            <div class="setting-item">
                                <label class="setting-label">Birthday</label>
                                <input type="date" id="contactBirthday" class="setting-input">
                            </div>
                            <div class="contact-form-buttons">
                                <button class="primary-btn" onclick="saveContact()" id="saveContactBtn">Add Contact</button>
                                <button class="secondary-btn" onclick="cancelEditContact()" id="cancelEditBtn" style="display: none;">Cancel</button>
                            </div>

                            <!-- CSV Import/Export Section -->
                            <div class="csv-section">
                                <h4>Import / Export</h4>
                                <div class="csv-buttons">
                                    <button class="secondary-btn small" onclick="importContactsCSV()">üì• Import CSV</button>
                                    <button class="secondary-btn small" onclick="exportContactsCSV()">üì§ Export CSV</button>
                                </div>
                                <p class="csv-hint">Google & Outlook compatible</p>
                                <input type="file" id="csvFileInput" accept=".csv" style="display: none;" onchange="handleCSVImport(event)">
                            </div>
                        </div>
                    </div>

                    <!-- Right Panel: Contacts List -->
                    <div class="address-book-list-panel">
                        <div class="contacts-list-header">
                            <h2 class="settings-title">My Contacts</h2>
                            <div class="contacts-search">
                                <input type="text" id="contactSearchInput" class="setting-input" placeholder="üîç Search contacts..." oninput="filterContacts()">
                            </div>
                            <div class="contacts-count" id="contactsCount">0 contacts</div>
                        </div>
                        <div class="contacts-bulk-bar" id="contactsBulkBar" style="display:none;">
                            <label class="contact-select-all-label">
                                <input type="checkbox" id="selectAllContacts" onchange="toggleSelectAllContacts()">
                                <span>Select All</span>
                            </label>
                            <span id="selectedCount">0 selected</span>
                            <button class="bulk-delete-btn" onclick="deleteSelectedContacts()">Delete Selected</button>
                        </div>
                        <div class="contacts-list" id="contactsList"></div>
                    </div>
                </div>
            </div>

            <!-- Send Gratitude Screen -->
            <div id="sendGratitudeScreen" class="screen">
                <div class="settings-container">
                    <div class="settings-card">
                        <h2 class="settings-title">Send Gratitude</h2>

                        <div style="margin-bottom:24px;">
                            <p style="display:block;font-size:0.9375rem;font-weight:600;color:#2D2D2D;margin-bottom:8px;">Send via</p>
                            <div id="channelToggle" style="display:flex !important;visibility:visible !important;opacity:1 !important;border-radius:12px;overflow:hidden;border:3px solid #9BAF95;width:100%;height:50px;">
                                <div id="channelSms" onclick="selectChannel('sms')" style="display:flex !important;visibility:visible !important;flex:1;align-items:center;justify-content:center;background:#9BAF95;color:#ffffff;font-size:1rem;font-weight:700;cursor:pointer;user-select:none;">üì± SMS</div>
                                <div id="channelWhatsapp" onclick="selectChannel('whatsapp')" style="display:flex !important;visibility:visible !important;flex:1;align-items:center;justify-content:center;background:#f0f0f0;color:#5A5A5A;font-size:1rem;font-weight:700;cursor:pointer;user-select:none;">üí¨ WhatsApp</div>
                            </div>
                        </div>

                        <div class="setting-item">
                            <label class="setting-label">Select Contact</label>
                            <select id="recipientSelect" class="setting-input" onchange="handleRecipientChange()">
                                <option value="">Choose from address book...</option>
                            </select>
                        </div>

                        <div class="setting-item">
                            <label class="setting-label">Or Enter Phone Number</label>
                            <input type="tel" id="recipientPhone" class="setting-input" placeholder="Enter phone number" maxlength="20">
                        </div>

                        <div class="setting-item">
                            <label class="setting-label">Message</label>
                            <textarea id="gratitudeMessage" class="setting-input" placeholder="Write your gratitude message..." maxlength="500" rows="6"></textarea>
                            <div class="char-count"><span id="messageCharCount">0</span>/500</div>
                        </div>

                        <div id="whatsappNote" class="channel-note" style="display: none;">
                            Note: This will open WhatsApp with your message pre-filled. The recipient must have WhatsApp installed.
                        </div>

                        <button class="primary-btn" id="sendMessageBtn" onclick="sendGratitudeMessage()">Send SMS üíå</button>
                        <button class="secondary-btn" onclick="goHome()">Cancel</button>
                    </div>
                </div>
            </div>

            <!-- Admin Dashboard Screen -->
            <div id="adminScreen" class="screen">
                <div class="admin-container">
                    <div class="admin-header">
                        <h2 class="settings-title">Admin Dashboard</h2>
                        <div class="admin-tabs">
                            <button class="admin-tab active" onclick="switchAdminTab('users')">Users</button>
                            <button class="admin-tab" onclick="switchAdminTab('audit')">Audit Log</button>
                        </div>
                    </div>

                    <!-- Users Tab -->
                    <div id="adminUsersTab" class="admin-tab-content active">
                        <div class="admin-toolbar">
                            <input type="text" id="adminUserSearch" class="setting-input" placeholder="Search users..." oninput="filterAdminUsers()">
                            <button class="secondary-btn" onclick="refreshAdminUsers()">Refresh</button>
                        </div>
                        <div class="admin-users-list" id="adminUsersList">
                            <div class="admin-loading">Loading users...</div>
                        </div>
                    </div>

                    <!-- Audit Log Tab -->
                    <div id="adminAuditTab" class="admin-tab-content" style="display:none;">
                        <div class="admin-toolbar">
                            <select id="auditUserFilter" class="setting-input" onchange="filterAuditLogs()">
                                <option value="">All Users</option>
                            </select>
                            <select id="auditActionFilter" class="setting-input" onchange="filterAuditLogs()">
                                <option value="">All Actions</option>
                                <option value="login">Login</option>
                                <option value="logout">Logout</option>
                                <option value="entry_create">Entry Create</option>
                                <option value="entry_update">Entry Update</option>
                                <option value="entry_delete">Entry Delete</option>
                                <option value="contact_create">Contact Create</option>
                                <option value="contact_update">Contact Update</option>
                                <option value="contact_delete">Contact Delete</option>
                                <option value="message_send">Message Send</option>
                                <option value="admin_">Admin Actions</option>
                            </select>
                            <button class="secondary-btn" onclick="refreshAuditLogs()">Refresh</button>
                        </div>
                        <div class="admin-audit-list" id="adminAuditList">
                            <div class="admin-loading">Loading audit logs...</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- User Detail Modal -->
            <div id="userDetailModal" class="modal" style="display:none;">
                <div class="modal-dialog">
                    <div class="modal-header">
                        <h3 id="userDetailTitle">User Details</h3>
                        <button class="close-modal-btn" onclick="closeUserDetailModal()">√ó</button>
                    </div>
                    <div class="modal-body" id="userDetailContent">
                        <!-- User details will be populated here -->
                    </div>
                    <div class="modal-footer" id="userDetailActions">
                        <!-- Action buttons will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Media Viewer Modal -->
            <div id="mediaModal" class="modal" onclick="closeMediaModal()">
                <span class="close-modal">√ó</span>
                <div class="modal-content" onclick="event.stopPropagation()">
                    <div id="mediaViewer"></div>
                    <div class="media-nav">
                        <button onclick="prevMedia(); event.stopPropagation()">‚¨ÖÔ∏è</button>
                        <span id="mediaCounter">1/3</span>
                        <button onclick="nextMedia(); event.stopPropagation()">‚û°Ô∏è</button>
                    </div>
                </div>
            </div>

            <!-- Camera Capture Modal -->
            <div id="cameraModal" class="modal">
                <span class="close-modal" onclick="closeCameraModal()">√ó</span>
                <div class="camera-content" onclick="event.stopPropagation()">
                    <video id="cameraPreview" autoplay playsinline></video>
                    <canvas id="cameraCanvas" style="display: none;"></canvas>
                    <div class="camera-controls">
                        <button class="camera-btn" id="capturePhotoBtn" onclick="capturePhoto()">üì∑ Take Photo</button>
                        <button class="camera-btn" id="startRecordBtn" onclick="startRecording()">üé• Start Recording</button>
                        <button class="camera-btn" id="stopRecordBtn" onclick="stopRecording()" style="display: none;">‚èπÔ∏è Stop Recording</button>
                        <button class="secondary-btn" onclick="closeCameraModal()">Cancel</button>
                    </div>
                </div>
            </div>
        </main>

        <!-- Toast Notifications -->
        <div id="toast" class="toast"></div>

        <!-- Footer -->
        <footer id="footer">
            <p>¬© 2025 Flourishly. All rights reserved.</p>
        </footer>
    </div>

    <!-- Firebase SDKs (compat mode) -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

    <!-- App Scripts (order matters) -->
    <script>
        // Verify Firebase loaded before continuing
        if (typeof firebase === 'undefined') {
            document.body.innerHTML = '<div style="padding:40px;text-align:center;font-family:sans-serif;">' +
                '<h2>Failed to load Firebase</h2>' +
                '<p>Check your internet connection and refresh the page.</p></div>';
        }
    </script>
    <script src="firebase-config.js"></script>
    <script src="database.js"></script>
    <script src="app.js"></script>
    <script src="auth.js"></script>
</body>
</html>
